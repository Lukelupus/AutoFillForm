<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  
  <div class="app">
    <div class="headers"></div>
    <div class="form-wrapper">
      <form id="payment-form" action="">
        <p>Complete os dados para a confirmação da sua inscrição!</p>
        <div class="form-step" style="display: none;">
          <div class="input-field">
            <label for="3824d0e8-906b-4f79-ac0f-b3dcb4140629">Nome Completo</label>
            <input id="3824d0e8-906b-4f79-ac0f-b3dcb4140629" type="text" placeholder="" class="">
          </div>

          <div class="input-field">
            <label for="5501dc52-68bf-42e1-bb9c-4913a681a576">Telefone</label>
            <input id="5501dc52-68bf-42e1-bb9c-4913a681a576" type="text" placeholder="" class="">
          </div>

          <div class="input-field">
            <label for="9f7b5ad6-56ce-4262-aa5e-6e66d7ec75e3">E-mail</label>
            <input id="9f7b5ad6-56ce-4262-aa5e-6e66d7ec75e3" type="email" placeholder="" class="">
          </div>
        </div>
        <div class="form-step" style="display: none;">
          <div class="input-field">
            <label for="3b253157-c133-405b-a3ab-6fc07086b45f">CEP</label>
            <input id="3b253157-c133-405b-a3ab-6fc07086b45f" type="text" placeholder="" class="">
          </div>

          <div class="input-field">
            <label for="afd0e6f6-f92c-441e-9bcc-09eb80792da9">Endereço</label>
            <input id="afd0e6f6-f92c-441e-9bcc-09eb80792da9" type="text" placeholder="" class="">
          </div>

          <div class="input-field">
            <label for="97035698-2162-4c3b-b147-4f2d46b26f98">Cidade</label>
            <input id="97035698-2162-4c3b-b147-4f2d46b26f98" type="text" placeholder="" class="">
          </div>

          <div class="input-field">
            <label for="612646c1-bc4b-4c50-a9e6-011ed5e7e5d1">Estado</label>
            <input id="612646c1-bc4b-4c50-a9e6-011ed5e7e5d1" type="text" placeholder="" class="">
          </div>
        </div>
        <div class="form-step" style="display: block;">
          <div class="input-field">
            <label for="784eb7e5-876d-4910-9acd-e7191e3df1d2">Nome do Titular</label>
            <input id="784eb7e5-876d-4910-9acd-e7191e3df1d2" type="text" placeholder="" class="">
          </div>

          <div class="input-field">
            <label for="ee070392-17fe-457b-b6cc-de4cac906d6f">Número do Cartão</label>
            <input id="ee070392-17fe-457b-b6cc-de4cac906d6f" type="text" placeholder="" class=" invalid">
          </div>

          <div class="input-field">
            <label for="52d9826c-8b11-4d97-a38b-087bb6c86931">Data de Validade</label>
            <input id="52d9826c-8b11-4d97-a38b-087bb6c86931" type="text" placeholder="Ex.: 03/2023" class=" invalid">
          </div>

          <div class="input-field">
            <label for="a07cbecd-2646-40d4-9bed-244aa0c12934">CVV</label>
            <input id="a07cbecd-2646-40d4-9bed-244aa0c12934" type="text" placeholder="" class="">
          </div>
        </div>

        <div class="btn-container">
          <button type="button" id="previous-btn" onclick="nextPrev(-1)" style="display: inline;">
            Previous
          </button>
          <button type="button" id="next-btn" onclick="nextPrev(1)">Next</button>
          <button type="button"  onclick="fillForm()">Fill Form</button>
          <button type="button"  onclick="changeParagraphs()">Change P</button>
        </div>

        <div style="text-align: center; margin-top: 40px">
          <span class="step finish finish"></span>
          <span class="step finish"></span>
          <span class="step active"></span>
        </div>
      </form>
    </div>

    <div class="congrats-wrapper" style="display: none">
      <h1>Parabéns!</h1>
      <p>Sua inscrição está confirmada!</p>
      <p>Você será redirecionado em <span id="timer">5</span> segundos...</p>
    </div>
  </div>
    <script>
class FilledForm {
  constructor(formId) {
    this.form = document.getElementById(formId);
    if (!this.form) {
      throw new Error(`Form ID ${formId} not found.`);
    }
  }

  fillField(labelText, value) {
    const labels = this.form.querySelectorAll("label");
    let inputField = null;
    labels.forEach((label) => {
      if (label.textContent.trim() === labelText) {
        const input = label.parentElement.querySelector("input");

        inputField = input;
      }
    });
    if (!inputField) {
      console.error(`Input field for label "${labelText}" not found.`);
      return;
    }
    inputField.value = value;
  }

  fillFields(fields) {
    for (const field in fields) {
      this.fillField(field, fields[field]);
    }
  }
}

class Validator {
  static validateEmail(email) {
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return regex.test(email.trim());
  }

  static validateCardNumber(cardNumber) {
    let sum = 0;
    let double = false;
    let numbers = cardNumber.split(" ").join("");
    for (let i = numbers.length - 1; i >= 0; i--) {
      let digit = parseInt(numbers.charAt(i), 10);

      if (double) {
        digit *= 2;
        if (digit > 9) digit -= 9;
      }

      sum += digit;
      double = !double;
    }

    return sum % 10 === 0;
  }

  static validateExpiryDate(expiryDate) {
    const today = new Date();
    const parts = expiryDate.split("/");
    const month = parseInt(parts[0], 10);
    const year = parseInt(parts[1], 10) + 2000;

    if (isNaN(month) || isNaN(year) || month < 1 || month > 12) {
      return false;
    }

    const cardExpiry = new Date(year, month - 1, 1);
    return cardExpiry > today;
  }
}
document.addEventListener("DOMContentLoaded", () => {
  const form = new FilledForm("payment-form");
  form.fillFields({
    "Nome Completo": "Lucas Bot",
    Telefone: "(31) 34414-5678",
    "E-mail": "luke@isthebest.com",
    CEP: "31310220",
    Endereço: "Rua OnSubmit if Correct",
    Cidade: "Belo Horizonte",
    Estado: "Minas Gerais",
    "Nome do Titular": "Lucas Bot",
    "Número do Cartão": "5524 3373 3249 3313",
    "Data de Validade": "12/25",
    CVV: "745",
  });

  const errors = [];
  const steps = form.form.querySelectorAll(".form-step");
  steps.forEach((step, index) => {
    const fields = step.querySelectorAll(".input-field input");
    fields.forEach((field) => {
      const label = field.parentElement.querySelector("label");
      const fieldName = label.textContent.trim();
      const fieldValue = field.value.trim();

      switch (fieldName) {
        case "E-mail":
          if (!Validator.validateEmail(fieldValue)) {
            errors.push("Please enter a valid email.");
          }
          break;
        case "Número do Cartão":
          if (!Validator.validateCardNumber(fieldValue)) {
            errors.push("Please enter a valid credit card number.");
          }
          break;
        case "Data de Validade":
          if (!Validator.validateExpiryDate(fieldValue)) {
            errors.push("Please enter a valid expiry date (MM/YY).");
          }
          break;
        default:
          break;
      }
    });
  });

  if (errors.length > 0) {
    const errorMessage = errors.join(" ");
    alert(errorMessage);
  } else {
    console.log("Form filled successfully!");
  }
});

function changeParagraphs() {
  const paragraph = document.querySelectorAll("p");
  paragraph.forEach((e) => {
    e.textContent = "Texto alterado";
  });
}


let currentStep = 0;
const formSteps = document.querySelectorAll('.form-step');

function nextPrev(n) {
  formSteps[currentStep].style.display = "none";
  currentStep += n;
  if (currentStep >= formSteps.length) {
    currentStep = formSteps.length - 1;
  }
  if (currentStep < 0) {
    currentStep = 0;
  }
  formSteps[currentStep].style.display = "block";
}

  </script>
</body>
</html>